#!/bin/sh

prefix_logs()
{
  while read line; do
    echo "`date`: $line"
  done
}

start()
{
  local self="`realpath "$0"`"
  local base="`dirname "$self"`"

  source "$base/../env" &&
  merge_environment /srv &&
  \
  local logs_dir="$PACKAGE_STORAGE/gammu/logs" &&
  \
  exec "$base/../private/gammu-monitor" 2>&1 |
    prefix_logs >> "$logs_dir/gammu-monitor.log"
}

main()
{
  start
  return "$?"
}

main
exit "$?"

